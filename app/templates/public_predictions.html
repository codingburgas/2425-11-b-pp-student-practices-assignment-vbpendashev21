{% extends "base.html" %}
{% block title %}
  {{ '–ü—É–±–ª–∏—á–Ω–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏' if session.get('lang') != 'en' else 'Public Predictions' }}
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">
        {{ '–ü—É–±–ª–∏—á–Ω–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏' if session.get('lang') != 'en' else 'Public Predictions' }}
    </h1>

    {% if predictions %}
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <table class="table table-hover rounded-3 overflow-hidden shadow-sm bg-white">
                    <thead class="table-light">
                        <tr>
                            <th>#</th>
                            <th>{{ '–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª' if session.get('lang') != 'en' else 'User' }}</th>
                            <th>{{ '–î–∞—Ç–∞' if session.get('lang') != 'en' else 'Date' }}</th>
                            <th>{{ '–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)' if session.get('lang') != 'en' else 'Temperature (¬∞C)' }}</th>
                            <th>{{ '–£—Å–ª–æ–≤–∏—è' if session.get('lang') != 'en' else 'Condition' }}</th>
                            <th>{{ '–û–±–ª–µ–∫–ª–æ' if session.get('lang') != 'en' else 'Outfit' }}</th>
                            <th>{{ '–£–≤–µ—Ä–µ–Ω–æ—Å—Ç' if session.get('lang') != 'en' else 'Confidence' }}</th>
                            <th>{{ '–û–ø–∏—Å–∞–Ω–∏–µ' if session.get('lang') != 'en' else 'Description' }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for prediction in predictions %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ prediction.user.username }}</td>
                            <td>{{ prediction.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                            <td>{{ prediction.temperature }}</td>
                            <td>
                                {% if session.get('lang') == 'en' %}
                                    {% if prediction.condition == 'sunny' %}Sunny ‚òÄÔ∏è
                                    {% elif prediction.condition == 'rain' %}Rain üåßÔ∏è
                                    {% elif prediction.condition == 'snow' %}Snow ‚ùÑÔ∏è
                                    {% else %}{{ prediction.condition }}{% endif %}
                                {% else %}
                                    {% if prediction.condition == 'sunny' %}–°–ª—ä–Ω—á–µ–≤–æ ‚òÄÔ∏è
                                    {% elif prediction.condition == 'rain' %}–î—ä–∂–¥ üåßÔ∏è
                                    {% elif prediction.condition == 'snow' %}–°–Ω—è–≥ ‚ùÑÔ∏è
                                    {% else %}{{ prediction.condition }}{% endif %}
                                {% endif %}
                            </td>
                            <td>
                                {# This is where you use the same translation dict as in routes.py if you want outfits translated too #}
                                {% set outfits = {
                                    "Shorts + T-shirt": "–ö—ä—Å–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏ + –¢–µ–Ω–∏—Å–∫–∞",
                                    "Pants + Shirt": "–ü–∞–Ω—Ç–∞–ª–æ–Ω + –†–∏–∑–∞",
                                    "Jacket + Jeans": "–Ø–∫–µ + –î—ä–Ω–∫–∏",
                                    "Coat + Scarf": "–ü–∞–ª—Ç–æ + –®–∞–ª",
                                    "Dress": "–†–æ–∫–ª—è",
                                    "Jacket + Hoodie": "–Ø–∫–µ + –°—É–∏—Ç—à—ä—Ä—Ç",
                                    "T-shirt + Jeans": "–¢–µ–Ω–∏—Å–∫–∞ + –î—ä–Ω–∫–∏",
                                    "Sweater + Pants": "–ü—É–ª–æ–≤–µ—Ä + –ü–∞–Ω—Ç–∞–ª–æ–Ω",
                                    "Jacket": "–Ø–∫–µ",
                                    "Hoodie": "–°—É–∏—Ç—à—ä—Ä—Ç",
                                    "T-shirt": "–¢–µ–Ω–∏—Å–∫–∞",
                                    "Jeans": "–î—ä–Ω–∫–∏",
                                    "Shorts": "–ö—ä—Å–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏"
                                } %}
                                {% if session.get('lang') == 'bg' %}
                                    {{ outfits[prediction.predicted_outfit] if prediction.predicted_outfit in outfits else prediction.predicted_outfit }}
                                {% else %}
                                    {{ prediction.predicted_outfit }}
                                {% endif %}
                            </td>
                            <td>{{ prediction.confidence|round(2) }}</td>
                            <td>{{ prediction.description }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    {% else %}
        <p class="text-center mt-5 fs-5 text-secondary">
            {{ '–ù—è–º–∞ –Ω–∞–ª–∏—á–Ω–∏ –ø—É–±–ª–∏—á–Ω–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏.' if session.get('lang') != 'en' else 'No public predictions available.' }}
        </p>
    {% endif %}
</div>
{% endblock %}
